<!doctype html>
<html lang="fr-fr">
  <head>
    <title>Développer sur Google App Engine // Tech blog</title>
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.66.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="http://example.org/css/main.min.d59a293bff4cb6f7fcce92a5c9833de7107393f80e4efe3110eea46955464842.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Développer sur Google App Engine"/>
<meta name="twitter:description" content="Depuis 1 mois je teste le déploiement de services sur Google App Engine. Le moins que l’on puisse dire c’est que c’est loin d’être aussi simple que ce que j’avais vu pendant la Devoxx France. Je vous propose un petit tour sur ce que j’ai remarqué.
Le Data Store Même si Google propose une base SQL en version Beta, j’ai utilisé le datastore No SQL par défaut. Pour simplifier la gestion de la persistance, la librairie Objectify est très bien adaptée."/>

    <meta property="og:title" content="Développer sur Google App Engine" />
<meta property="og:description" content="Depuis 1 mois je teste le déploiement de services sur Google App Engine. Le moins que l’on puisse dire c’est que c’est loin d’être aussi simple que ce que j’avais vu pendant la Devoxx France. Je vous propose un petit tour sur ce que j’ai remarqué.
Le Data Store Même si Google propose une base SQL en version Beta, j’ai utilisé le datastore No SQL par défaut. Pour simplifier la gestion de la persistance, la librairie Objectify est très bien adaptée." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/2012/06/19/developper-sur-google-app-engine/" />
<meta property="article:published_time" content="2012-06-19T22:07:32+00:00" />
<meta property="article:modified_time" content="2012-06-19T22:07:32+00:00" />


  </head>
  <body>
    <header class="app-header">
      <a href="http://example.org/"><img class="app-header-avatar" src="/avatar.jpg" alt="John Doe" /></a>
      <h1>Tech blog</h1>
      <p>Vieux blog technique</p>
      <div class="app-header-social">
        
          <a target="_blank" href="https://github.com/sliard" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg></a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Développer sur Google App Engine</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jun 19, 2012
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          2 min read
        </div><div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line>
</svg>
          <a class="tag" href="http://example.org/tags/cloud/">cloud</a><a class="tag" href="http://example.org/tags/cloud/">cloud</a><a class="tag" href="http://example.org/tags/gae/">GAE</a><a class="tag" href="http://example.org/tags/google/">Google</a><a class="tag" href="http://example.org/tags/google/">Google</a></div></div>
    </header>
    <div class="post-content">
      <p>Depuis 1 mois je teste le déploiement de services sur Google App Engine. Le moins que l’on puisse dire c’est que c’est loin d’être aussi simple que ce que j’avais vu pendant la Devoxx France. Je vous propose un petit tour sur ce que j’ai remarqué.</p>
<h2 id="le-data-store">Le Data Store</h2>
<p>Même si Google propose une base SQL en version Beta, j’ai utilisé le datastore No SQL par défaut. Pour simplifier la gestion de la persistance, la librairie <a href="http://code.google.com/p/objectify-appengine/">Objectify</a> est très bien adaptée. La première chose à faire est de bien identifier les champs à indexer. Par défaut un paramètre est indexé, mais plus il y a d’index plus le coût d’écriture est important.</p>
<p>Attention aussi à la notion d’objet embeded. On ne peut le faire qu’à un niveau. Donc une classe embeded ne peut pas avoir d’attribut List.</p>
<p>Mais la plus grosse surprise que j’ai eue c’est que l’écriture se fait de façon asynchrone. Après avoir persisté un objet il faut attendre 5-6s pour pouvoir le lire en base. Il faut donc ruser et utiliser des caches pour masquer ce délai.</p>
<h2 id="le-blobstore">Le Blobstore</h2>
<p>C’est une des fonctions intéressantes du service. Elle permet de stocker facilement des fichiers, des images par exemple. Et pour les images justement il y a même une astuce pour les redimensionner.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Pour trouver de l’information sur cette fonction, il faut lire la version Anglaise de la doc. En effet au début on apprécie le fait que toute la doc de Google App Engine ait été traduite en Français. On déchante vite lorsqu’on s’aperçoit que cette dernière n’est pas au même niveau que la version anglaise. Donc n’oubliez pas de lire la VO <!-- raw HTML omitted --></p>
<p>Pour revenir au BlobStore, j’ai eu un problème pour gérer les fichiers non renseignés dans un formulaire. Sur un formulaire où l’utilisateur peut éventuellement uploader 1 fichier, un blobstore vide est créé s’il n’y a pas de fichier.</p>
<p>Ce comportement est d’autant plus étrange qu’on ne le retrouve pas sur le serveur local en mode dev. Une autre leçon à retenir : tester au plus tôt en production votre code.</p>
<p>Pour résoudre le problème, il faut tester la taille du fichier uploadé pour ensuite le supprimer s’il est vide.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="a-suivre">A suivre</h2>
<p>Je termine là mes remarques sur la partie purement dev de Google App Engine. Mais j’ai eu d’autres surprises que je vous détaillerai prochainement.</p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
